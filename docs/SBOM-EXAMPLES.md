# SBOM Examples

This document provides examples of CycloneDX SBOMs generated by CycloneDX.MSBuild to help you understand the output format and structure.

## Table of Contents

- [JSON Format Example](#json-format-example)
- [XML Format Example](#xml-format-example)
- [Understanding the Structure](#understanding-the-structure)
- [Real-World Example](#real-world-example)

## JSON Format Example

This is a minimal example of a CycloneDX SBOM in JSON format:

```json
{
  "bomFormat": "CycloneDX",
  "specVersion": "1.6",
  "serialNumber": "urn:uuid:3e671687-395b-41f5-a30f-a58921a69b79",
  "version": 1,
  "metadata": {
    "timestamp": "2025-12-01T10:30:00Z",
    "tools": [
      {
        "vendor": "CycloneDX",
        "name": "cyclonedx-dotnet",
        "version": "5.5.0"
      }
    ],
    "component": {
      "type": "application",
      "bom-ref": "pkg:nuget/MyApplication@1.0.0",
      "name": "MyApplication",
      "version": "1.0.0",
      "purl": "pkg:nuget/MyApplication@1.0.0"
    }
  },
  "components": [
    {
      "type": "library",
      "bom-ref": "pkg:nuget/Newtonsoft.Json@13.0.3",
      "name": "Newtonsoft.Json",
      "version": "13.0.3",
      "description": "Json.NET is a popular high-performance JSON framework for .NET",
      "licenses": [
        {
          "license": {
            "id": "MIT"
          }
        }
      ],
      "purl": "pkg:nuget/Newtonsoft.Json@13.0.3",
      "externalReferences": [
        {
          "url": "https://www.nuget.org/packages/Newtonsoft.Json/13.0.3",
          "type": "distribution"
        },
        {
          "url": "https://github.com/JamesNK/Newtonsoft.Json",
          "type": "vcs"
        }
      ]
    },
    {
      "type": "library",
      "bom-ref": "pkg:nuget/Serilog@3.1.1",
      "name": "Serilog",
      "version": "3.1.1",
      "description": "Simple .NET logging with fully-structured events",
      "licenses": [
        {
          "license": {
            "id": "Apache-2.0"
          }
        }
      ],
      "purl": "pkg:nuget/Serilog@3.1.1",
      "externalReferences": [
        {
          "url": "https://www.nuget.org/packages/Serilog/3.1.1",
          "type": "distribution"
        },
        {
          "url": "https://github.com/serilog/serilog",
          "type": "vcs"
        }
      ]
    }
  ],
  "dependencies": [
    {
      "ref": "pkg:nuget/MyApplication@1.0.0",
      "dependsOn": [
        "pkg:nuget/Newtonsoft.Json@13.0.3",
        "pkg:nuget/Serilog@3.1.1"
      ]
    },
    {
      "ref": "pkg:nuget/Newtonsoft.Json@13.0.3",
      "dependsOn": []
    },
    {
      "ref": "pkg:nuget/Serilog@3.1.1",
      "dependsOn": []
    }
  ]
}
```

## XML Format Example

The same SBOM in XML format (when using `<CycloneDxOutputFormat>xml</CycloneDxOutputFormat>`):

```xml
<?xml version="1.0" encoding="utf-8"?>
<bom xmlns="http://cyclonedx.org/schema/bom/1.6" serialNumber="urn:uuid:3e671687-395b-41f5-a30f-a58921a69b79" version="1">
  <metadata>
    <timestamp>2025-12-01T10:30:00Z</timestamp>
    <tools>
      <tool>
        <vendor>CycloneDX</vendor>
        <name>cyclonedx-dotnet</name>
        <version>5.5.0</version>
      </tool>
    </tools>
    <component type="application" bom-ref="pkg:nuget/MyApplication@1.0.0">
      <name>MyApplication</name>
      <version>1.0.0</version>
      <purl>pkg:nuget/MyApplication@1.0.0</purl>
    </component>
  </metadata>
  <components>
    <component type="library" bom-ref="pkg:nuget/Newtonsoft.Json@13.0.3">
      <name>Newtonsoft.Json</name>
      <version>13.0.3</version>
      <description>
        <![CDATA[Json.NET is a popular high-performance JSON framework for .NET]]>
      </description>
      <licenses>
        <license>
          <id>MIT</id>
        </license>
      </licenses>
      <purl>pkg:nuget/Newtonsoft.Json@13.0.3</purl>
      <externalReferences>
        <reference type="distribution">
          <url>https://www.nuget.org/packages/Newtonsoft.Json/13.0.3</url>
        </reference>
        <reference type="vcs">
          <url>https://github.com/JamesNK/Newtonsoft.Json</url>
        </reference>
      </externalReferences>
    </component>
    <component type="library" bom-ref="pkg:nuget/Serilog@3.1.1">
      <name>Serilog</name>
      <version>3.1.1</version>
      <description>
        <![CDATA[Simple .NET logging with fully-structured events]]>
      </description>
      <licenses>
        <license>
          <id>Apache-2.0</id>
        </license>
      </licenses>
      <purl>pkg:nuget/Serilog@3.1.1</purl>
      <externalReferences>
        <reference type="distribution">
          <url>https://www.nuget.org/packages/Serilog/3.1.1</url>
        </reference>
        <reference type="vcs">
          <url>https://github.com/serilog/serilog</url>
        </reference>
      </externalReferences>
    </component>
  </components>
  <dependencies>
    <dependency ref="pkg:nuget/MyApplication@1.0.0">
      <dependency ref="pkg:nuget/Newtonsoft.Json@13.0.3"/>
      <dependency ref="pkg:nuget/Serilog@3.1.1"/>
    </dependency>
    <dependency ref="pkg:nuget/Newtonsoft.Json@13.0.3"/>
    <dependency ref="pkg:nuget/Serilog@3.1.1"/>
  </dependencies>
</bom>
```

## Understanding the Structure

### Top-Level Fields

| Field | Description | Required |
|-------|-------------|----------|
| `bomFormat` | Always "CycloneDX" | ✅ |
| `specVersion` | CycloneDX spec version (1.2-1.6) | ✅ |
| `serialNumber` | Unique identifier (URN UUID format) | Optional |
| `version` | SBOM document version (incremented on updates) | ✅ |
| `metadata` | Information about the SBOM and main component | Optional |
| `components` | List of all dependencies | Optional |
| `dependencies` | Dependency graph relationships | Optional |

### Metadata Section

The metadata section contains information about:

1. **Timestamp**: When the SBOM was generated
2. **Tools**: Tools used to generate the SBOM (cyclonedx-dotnet)
3. **Component**: The main application/library being described

```json
"metadata": {
  "timestamp": "2025-12-01T10:30:00Z",
  "tools": [...],
  "component": {
    "type": "application",        // or "library"
    "bom-ref": "pkg:nuget/...",   // Package URL
    "name": "MyApplication",
    "version": "1.0.0",
    "purl": "pkg:nuget/MyApplication@1.0.0"
  }
}
```

### Components Section

Each component (dependency) includes:

| Field | Description | Example |
|-------|-------------|---------|
| `type` | Component type | `"library"`, `"application"` |
| `bom-ref` | Unique reference within SBOM | `"pkg:nuget/Newtonsoft.Json@13.0.3"` |
| `name` | Package name | `"Newtonsoft.Json"` |
| `version` | Package version | `"13.0.3"` |
| `description` | Package description | `"Json.NET is a..."` |
| `licenses` | License information | `[{"license": {"id": "MIT"}}]` |
| `purl` | Package URL (PURL) | `"pkg:nuget/Newtonsoft.Json@13.0.3"` |
| `externalReferences` | Links to package sources | URLs for NuGet, GitHub, etc. |

### Package URLs (PURLs)

CycloneDX uses Package URLs to uniquely identify components:

**Format**: `pkg:<type>/<namespace>/<name>@<version>`

**Examples**:
- `pkg:nuget/Newtonsoft.Json@13.0.3` - NuGet package
- `pkg:npm/react@18.2.0` - npm package
- `pkg:maven/org.springframework/spring-core@6.0.0` - Maven package
- `pkg:github/microsoft/dotnet@v8.0.0` - GitHub release

### Dependencies Section

The dependencies section shows the dependency graph:

```json
"dependencies": [
  {
    "ref": "pkg:nuget/MyApplication@1.0.0",
    "dependsOn": [
      "pkg:nuget/Newtonsoft.Json@13.0.3",
      "pkg:nuget/Serilog@3.1.1"
    ]
  },
  {
    "ref": "pkg:nuget/Newtonsoft.Json@13.0.3",
    "dependsOn": []  // No dependencies
  }
]
```

This shows that MyApplication depends on Newtonsoft.Json and Serilog, which have no further dependencies.

### Licenses

Licenses can be specified in multiple ways:

**SPDX License ID** (preferred):
```json
"licenses": [
  {
    "license": {
      "id": "MIT"
    }
  }
]
```

**License Name** (when SPDX ID not available):
```json
"licenses": [
  {
    "license": {
      "name": "Custom License"
    }
  }
]
```

**License Expression** (for complex licensing):
```json
"licenses": [
  {
    "expression": "MIT OR Apache-2.0"
  }
]
```

### External References

External references provide links to additional resources:

| Type | Description | Example URL |
|------|-------------|-------------|
| `distribution` | Package distribution | `https://www.nuget.org/packages/...` |
| `vcs` | Version control system | `https://github.com/...` |
| `website` | Project website | `https://example.com` |
| `issue-tracker` | Bug tracker | `https://github.com/.../issues` |
| `documentation` | Documentation | `https://docs.example.com` |
| `release-notes` | Release notes | `https://github.com/.../releases` |

## Real-World Example

Here's a more complex example with transitive dependencies:

```json
{
  "bomFormat": "CycloneDX",
  "specVersion": "1.6",
  "serialNumber": "urn:uuid:abc123...",
  "version": 1,
  "metadata": {
    "timestamp": "2025-12-01T10:30:00Z",
    "tools": [
      {
        "vendor": "CycloneDX",
        "name": "cyclonedx-dotnet",
        "version": "5.5.0"
      }
    ],
    "component": {
      "type": "application",
      "bom-ref": "pkg:nuget/WebApi@2.1.0",
      "name": "WebApi",
      "version": "2.1.0",
      "description": "REST API for customer management",
      "licenses": [
        {
          "license": {
            "id": "Apache-2.0"
          }
        }
      ],
      "purl": "pkg:nuget/WebApi@2.1.0"
    }
  },
  "components": [
    {
      "type": "library",
      "bom-ref": "pkg:nuget/Microsoft.AspNetCore.App@8.0.0",
      "name": "Microsoft.AspNetCore.App",
      "version": "8.0.0",
      "description": "ASP.NET Core shared framework",
      "licenses": [
        {
          "license": {
            "id": "MIT"
          }
        }
      ],
      "purl": "pkg:nuget/Microsoft.AspNetCore.App@8.0.0"
    },
    {
      "type": "library",
      "bom-ref": "pkg:nuget/Newtonsoft.Json@13.0.3",
      "name": "Newtonsoft.Json",
      "version": "13.0.3",
      "description": "Json.NET is a popular high-performance JSON framework for .NET",
      "licenses": [
        {
          "license": {
            "id": "MIT"
          }
        }
      ],
      "purl": "pkg:nuget/Newtonsoft.Json@13.0.3",
      "externalReferences": [
        {
          "url": "https://www.nuget.org/packages/Newtonsoft.Json/13.0.3",
          "type": "distribution"
        },
        {
          "url": "https://github.com/JamesNK/Newtonsoft.Json",
          "type": "vcs"
        },
        {
          "url": "https://www.newtonsoft.com/json",
          "type": "website"
        }
      ]
    },
    {
      "type": "library",
      "bom-ref": "pkg:nuget/Serilog@3.1.1",
      "name": "Serilog",
      "version": "3.1.1",
      "licenses": [
        {
          "license": {
            "id": "Apache-2.0"
          }
        }
      ],
      "purl": "pkg:nuget/Serilog@3.1.1"
    },
    {
      "type": "library",
      "bom-ref": "pkg:nuget/Serilog.Sinks.Console@5.0.0",
      "name": "Serilog.Sinks.Console",
      "version": "5.0.0",
      "licenses": [
        {
          "license": {
            "id": "Apache-2.0"
          }
        }
      ],
      "purl": "pkg:nuget/Serilog.Sinks.Console@5.0.0"
    }
  ],
  "dependencies": [
    {
      "ref": "pkg:nuget/WebApi@2.1.0",
      "dependsOn": [
        "pkg:nuget/Microsoft.AspNetCore.App@8.0.0",
        "pkg:nuget/Newtonsoft.Json@13.0.3",
        "pkg:nuget/Serilog@3.1.1"
      ]
    },
    {
      "ref": "pkg:nuget/Microsoft.AspNetCore.App@8.0.0",
      "dependsOn": []
    },
    {
      "ref": "pkg:nuget/Newtonsoft.Json@13.0.3",
      "dependsOn": []
    },
    {
      "ref": "pkg:nuget/Serilog@3.1.1",
      "dependsOn": [
        "pkg:nuget/Serilog.Sinks.Console@5.0.0"
      ]
    },
    {
      "ref": "pkg:nuget/Serilog.Sinks.Console@5.0.0",
      "dependsOn": []
    }
  ]
}
```

This example shows:
- A web API application with multiple dependencies
- Transitive dependencies (Serilog depends on Serilog.Sinks.Console)
- Complete license information
- External references (URLs)
- Dependency relationships

## Using the SBOM

### Analyzing Dependencies

**Count total dependencies**:
```bash
cat sbom.json | jq '.components | length'
```

**List all package names**:
```bash
cat sbom.json | jq '.components[].name'
```

**Find specific package**:
```bash
cat sbom.json | jq '.components[] | select(.name == "Newtonsoft.Json")'
```

**List all licenses**:
```bash
cat sbom.json | jq '.components[].licenses[].license.id' | sort -u
```

### Vulnerability Scanning

Use the SBOM with vulnerability scanners:

**OWASP Dependency-Track**:
```bash
# Upload SBOM to Dependency-Track
curl -X POST "https://dtrack.example.com/api/v1/bom" \
  -H "X-Api-Key: ${API_KEY}" \
  -H "Content-Type: multipart/form-data" \
  -F "project=${PROJECT_UUID}" \
  -F "bom=@sbom.json"
```

**Grype** (Anchore):
```bash
grype sbom:sbom.json
```

**Trivy**:
```bash
trivy sbom sbom.json
```

### Supply Chain Analysis

**Identify direct vs transitive dependencies**:
```bash
# Direct dependencies (dependencies of the main component)
cat sbom.json | jq '.dependencies[] | select(.ref | contains("MyApplication")) | .dependsOn[]'

# All transitive dependencies
cat sbom.json | jq '.dependencies[] | select(.dependsOn | length > 0) | {package: .ref, deps: .dependsOn}'
```

**License compliance check**:
```bash
# List all unique licenses
cat sbom.json | jq -r '.components[].licenses[]?.license.id // "Unknown"' | sort | uniq -c

# Find non-permissive licenses
cat sbom.json | jq '.components[] | select(.licenses[].license.id != "MIT" and .licenses[].license.id != "Apache-2.0")'
```

## Additional Resources

- [CycloneDX Specification](https://cyclonedx.org/specification/overview/)
- [CycloneDX Use Cases](https://cyclonedx.org/use-cases/)
- [Package URL Specification](https://github.com/package-url/purl-spec)
- [SPDX License List](https://spdx.org/licenses/)
- [OWASP Dependency-Track](https://dependencytrack.org/)

---

*Last updated: December 1, 2025*
